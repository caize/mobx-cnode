webpackJsonp([0,3],{0:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(1),a=r(o),i=n(31),c=r(i),u=n(169),l=r(u),s=n(561),f=r(s),p=document.createElement("div");p.id="app",document.body.appendChild(p);var d=new l.default;c.default.render(a.default.createElement(f.default,{store:d}),document.querySelector("#app"))},169:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(t,"__esModule",{value:!0});var c,u,l,s,f,p,d,y,h,m,b,g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_=n(170),w=n(171),O=r(w),E=n(173),j=n(558),P=r(j),k=n(559),T=n(560),C=(c=function(){function e(){a(this,e),this.topicLimit=20,o(this,"topicsPage",u,this),o(this,"topics",l,this),o(this,"tab",s,this),o(this,"topic",f,this),o(this,"user",p,this),o(this,"accessToken",d,this),o(this,"currentUser",y,this),o(this,"collectTopics",h,this),o(this,"messages",m,this),o(this,"comment",b,this)}return v(e,[{key:"changeTopicsPage",value:function(e){this.fetchTopics({page:e,tab:this.tab})}},{key:"fetchTopics",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{page:1};(0,O.default)(""+P.default.path+P.default.topics+"?page="+(t.page||1)+"&tab="+(t.tab||"all")).then(function(e){return e.json()}).then(function(n){if(!n.success)throw new Error(n.error_msg);e.topics=n.data,e.topicsPage=t.page?t.page:1,e.tab=t.tab?t.tab:"all"}).catch(function(e){return E.Notify.error(e.message?e.message:"网络错误")})}},{key:"changeTab",value:function(e){this.tab=e}},{key:"fetchTopic",value:function(e){var t=this;this.topic=null,(0,O.default)(""+P.default.path+P.default.topic+"/"+e+"?accesstoken="+(this.currentUser?this.currentUser.accesstoken:"")).then(function(e){return e.json()}).then(function(e){if(!e.success)throw new Error(e.error_msg);t.topic=e.data,t.comment=""}).catch(function(e){return E.Notify.error(e.message?e.message:"网络错误")})}},{key:"fetchUser",value:function(e){var t=this;this.user=null,(0,O.default)(""+P.default.path+P.default.user+"/"+e).then(function(e){return e.json()}).then(function(e){if(!e.success)throw new Error(e.error_msg);t.user=e.data}).catch(function(e){return E.Notify.error(e.message?e.message:"网络错误")})}},{key:"changeAccessToken",value:function(e){this.accessToken=e}},{key:"login",value:function(e){var t=this;(0,O.default)(""+P.default.path+P.default.accesstoken,(0,k.toPostData)({accesstoken:e})).then(function(e){return e.json()}).then(function(n){if(!n.success)throw new Error(n.error_msg);t.accessToken="";var r={loginname:n.loginname,avatar_url:n.avatar_url,id:n.id,accesstoken:e};return(0,k.setLocal)(T.currentUserKey,r),t.currentUser=r,r.loginname}).then(function(e){return(0,O.default)(""+P.default.path+P.default.user+"/"+e)}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw new Error(e.error_msg);t.currentUser=g(t.currentUser,e.data)}).catch(function(e){return E.Notify.error(e.message?e.message:"网络错误")})}},{key:"logout",value:function(){this.currentUser=null,(0,k.setLocal)(T.currentUserKey,null)}},{key:"collectTopic",value:function(e,t){var n=this,r=t?""+P.default.path+P.default.deCollect:""+P.default.path+P.default.collect;(0,O.default)(r,(0,k.toPostData)({accesstoken:this.currentUser.accesstoken,topic_id:e})).then(function(e){return e.json()}).then(function(e){if(!e.success)throw new Error(e.error_msg);n.topic.is_collect=!t}).catch(function(e){return E.Notify.error(e.message?e.message:"网络错误")})}},{key:"fetchCollectTopics",value:function(e){var t=this;(0,O.default)(""+P.default.path+P.default.topicCollect+"/"+e).then(function(e){return e.json()}).then(function(e){if(!e.success)throw new Error(e.error_msg);t.collectTopics=e.data}).catch(function(e){return E.Notify.error(e.message?e.message:"网络错误")})}},{key:"fetchMessages",value:function(e){var t=this;(0,O.default)(""+P.default.path+P.default.messages+"?accesstoken="+this.currentUser.accesstoken).then(function(e){return e.json()}).then(function(e){if(!e.success)throw new Error(e.error_msg);t.messages=e.data}).catch(function(e){return E.Notify.error(e.message?e.message:"网络错误")})}},{key:"markOne",value:function(e){var t=this;(0,O.default)(""+P.default.path+P.default.messageMarkOne+"/"+e,(0,k.toPostData)({accesstoken:this.currentUser.accesstoken})).then(function(e){return e.json()}).then(function(e){if(!e.success)throw new Error(e.error_msg);t.fetchMessages(t.currentUser.loginname)}).catch(function(e){return E.Notify.error(e.message?e.message:"网络错误")})}},{key:"agreeReply",value:function(e){var t=this;(0,O.default)(""+P.default.path+P.default.ups[0]+"/"+e+"/"+P.default.ups[1],(0,k.toPostData)({accesstoken:this.currentUser.accesstoken})).then(function(e){return e.json()}).then(function(n){if(!n.success)throw new Error(n.error_msg);for(var r="up"===n.action?1:-1,o=0,a=t.topic.replies.length;o<a;o+=1)if(t.topic.replies[o].id===e)return 1===r?t.topic.replies[o].ups.push(t.currentUser.id):t.topic.replies[o].ups.pop(),void(t.topic.replies[o].is_uped=!t.topic.replies[o].is_uped)}).catch(function(e){return E.Notify.error(e.message?e.message:"网络错误")})}},{key:"changeComment",value:function(e){this.comment=e}},{key:"createComment",value:function(e,t){var n=this;(0,O.default)(""+P.default.path+P.default.comment[0]+"/"+e+"/"+P.default.comment[1],(0,k.toPostData)({accesstoken:this.currentUser.accesstoken,content:t})).then(function(e){return e.json()}).then(function(t){if(!t.success)throw new Error(t.error_msg);n.fetchTopic(e)}).catch(function(e){return E.Notify.error(e.message?e.message:"网络错误")})}}]),e}(),u=i(c.prototype,"topicsPage",[_.observable],{enumerable:!0,initializer:function(){return 1}}),i(c.prototype,"changeTopicsPage",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"changeTopicsPage"),c.prototype),l=i(c.prototype,"topics",[_.observable],{enumerable:!0,initializer:function(){return[]}}),i(c.prototype,"fetchTopics",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchTopics"),c.prototype),s=i(c.prototype,"tab",[_.observable],{enumerable:!0,initializer:function(){return"all"}}),i(c.prototype,"changeTab",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"changeTab"),c.prototype),f=i(c.prototype,"topic",[_.observable],{enumerable:!0,initializer:function(){return null}}),i(c.prototype,"fetchTopic",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchTopic"),c.prototype),p=i(c.prototype,"user",[_.observable],{enumerable:!0,initializer:function(){return null}}),i(c.prototype,"fetchUser",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchUser"),c.prototype),d=i(c.prototype,"accessToken",[_.observable],{enumerable:!0,initializer:function(){return""}}),i(c.prototype,"changeAccessToken",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"changeAccessToken"),c.prototype),y=i(c.prototype,"currentUser",[_.observable],{enumerable:!0,initializer:function(){return null}}),i(c.prototype,"login",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"login"),c.prototype),i(c.prototype,"logout",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"logout"),c.prototype),i(c.prototype,"collectTopic",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"collectTopic"),c.prototype),h=i(c.prototype,"collectTopics",[_.observable],{enumerable:!0,initializer:function(){return[]}}),i(c.prototype,"fetchCollectTopics",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchCollectTopics"),c.prototype),m=i(c.prototype,"messages",[_.observable],{enumerable:!0,initializer:function(){return null}}),i(c.prototype,"fetchMessages",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchMessages"),c.prototype),i(c.prototype,"markOne",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"markOne"),c.prototype),i(c.prototype,"agreeReply",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"agreeReply"),c.prototype),b=i(c.prototype,"comment",[_.observable],{enumerable:!0,initializer:function(){return""}}),i(c.prototype,"changeComment",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"changeComment"),c.prototype),i(c.prototype,"createComment",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"createComment"),c.prototype),c);t.default=C},558:function(e,t){"use strict";e.exports={port:8001,path:"https://cnodejs.org/api/v1/",topics:"topics",topic:"topic",user:"user",accesstoken:"accesstoken",topicCollect:"topic_collect",collect:"topic_collect/collect",deCollect:"topic_collect/de_collect",messages:"messages",messageMarkOne:"message/mark_one",ups:["reply","ups"],comment:["topic","replies"]}},559:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.toPostData=function(e){return{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Object.entries(e).map(function(e){return e[0]+"="+e[1]}).join("&")}},t.setLocal=function(e,t){localStorage[e]=JSON.stringify(t)},t.getLocal=function(e){var t=localStorage[e];return t?JSON.parse(t):null}},560:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tabs=[["all","全部"],["good","精华"],["share","分享"],["ask","问答"],["job","招聘"]],t.tabsIndex=new Map([["all",0],["good",1],["share",2],["ask",3],["job",4]]),t.currentUserKey="MOBX_CNODE_USER"},561:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=r(u),s=n(562),f=n(602),p=r(f),d=n(666),y=r(d),h=n(668),m=r(h),b=n(669),g=r(b),v=n(674),_=r(v),w=n(678),O=r(w),E=n(559),j=n(560);n(680),n(684);var P={page:{paddingBottom:40,width:"90%",maxWidth:1400,minWidth:960,margin:"80px auto 15px",minHeight:400},content:{marginRight:305}},k=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),c(t,[{key:"componentWillMount",value:function(){var e=(0,E.getLocal)(j.currentUserKey);e&&(this.props.store.currentUser=e)}},{key:"render",value:function(){var e=this.props.store;return l.default.createElement(s.HashRouter,null,l.default.createElement("div",null,l.default.createElement(y.default,{store:e}),l.default.createElement("div",{style:P.page},l.default.createElement(m.default,{store:e}),l.default.createElement("div",{style:P.content},l.default.createElement(s.Route,{exact:!0,path:"/",render:function(){return l.default.createElement(g.default,{store:e})}}),l.default.createElement(s.Route,{path:"/topic/:id",render:function(t){var n=t.location;return l.default.createElement(_.default,{store:e,location:n})}}),l.default.createElement(s.Route,{path:"/user/:loginname",render:function(t){var n=t.location;return l.default.createElement(O.default,{store:e,location:n})}})))))}}]),t}(u.PureComponent);t.default=(0,p.default)(k)},666:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=r(u),s=n(667),f=n(562),p=n(602),d=r(p),y={wrapper:{position:"fixed",display:"flex",justifyContent:"space-between",alignItems:"center",top:0,height:60,width:"100%",boxShadow:"0 1px 4px rgba(0,0,0,.1)",zIndex:20},icon:{display:"flex",justifyContent:"center",padding:"0 20px",width:120,height:"100%",hover:"pointer"},img:{height:"100%",width:"100%"}},h=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"render",value:function(){return l.default.createElement("nav",{style:y.wrapper,className:"bg"},l.default.createElement(f.Link,{style:y.icon,to:"/"},l.default.createElement("img",{src:"//o4j806krb.qnssl.com/public/images/cnodejs.svg",alt:"",style:y.img})))}}]),t}(u.PureComponent);t.default=(0,d.default)((0,s.observer)(h))},668:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=r(u),s=n(602),f=r(s),p=n(667),d=n(562),y=n(173),h={sidebar:{float:"right",width:290},header:{padding:"10px 0 10px 20px"},title:{color:"#51585c"},content:{padding:20},userInfo:{display:"flex",alignItems:"center",justifyContent:"flex-start"},avatar:{width:40,height:40},name:{padding:"0 12px 0 6px"}},m=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"render",value:function(){var e=this.props.store,t=!!e.currentUser;return l.default.createElement("aside",{style:h.sidebar},l.default.createElement("section",{className:"bg radius"},l.default.createElement("header",{style:h.header,className:"top radius-top"},l.default.createElement("h5",{style:h.title},!t&&"登录",t&&"用户信息")),!t&&l.default.createElement("div",{style:h.content},l.default.createElement(y.Input,{className:"inline-input",placeholder:"输入access token",value:e.accessToken,onChange:function(t){return e.changeAccessToken(t.target.value)}}),l.default.createElement(y.Button,{className:"inline-button",type:"primary",onClick:function(){return e.login(e.accessToken)}},"登录")),t&&l.default.createElement("div",{style:[h.content,h.userInfo]},l.default.createElement(d.Link,{to:"/user/"+e.currentUser.loginname,style:h.userInfo},l.default.createElement("img",{style:h.avatar,src:e.currentUser.avatar_url,alt:""}),l.default.createElement("h4",{style:[h.name,h.title]},e.currentUser.loginname)),l.default.createElement(y.Button,{type:"primary",onClick:e.logout.bind(e)},"注销"))))}}]),t}(u.PureComponent);t.default=(0,f.default)((0,p.observer)(m))},669:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=r(u),s=n(170),f=n(667),p=n(562),d=n(602),y=r(d),h=n(173),m=n(670),b=r(m),g=n(671),v=r(g),_=n(672),w=r(_),O=n(673),E=r(O),j=new b.default,P={wrapper:{display:"flex",alignItems:"center"},img:{minWidth:30,width:30,height:30},count:{minWidth:70,width:70,textAlign:"center"},tab:{marginRight:16,minWidth:36},title:{color:"#000",":hover":{color:"#778087"}},time:{color:"#778087"}},k=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.columns=[{width:"50%",bodyRender:function(e){return l.default.createElement("div",{style:P.wrapper},l.default.createElement(p.Link,{to:"/user/"+e.author.loginname},l.default.createElement("img",{src:e.author.avatar_url,style:P.img})),l.default.createElement("div",{style:P.count},l.default.createElement("span",null,e.reply_count),"/",l.default.createElement("span",null,e.visit_count)),l.default.createElement(w.default,{data:e,style:P.tab}),l.default.createElement("p",null,l.default.createElement(p.Link,{style:P.title,to:"/topic/"+e.id},e.title)))}},{bodyRender:function(e){return l.default.createElement("span",{style:P.time},j.format(e.last_reply_at,"zh_CN"))}}],n}return i(t,e),c(t,[{key:"componentWillMount",value:function(){this.props.store.fetchTopics()}},{key:"render",value:function(){var e=this.props.store;return l.default.createElement("div",{className:"bg radius"},l.default.createElement(v.default,{store:e}),l.default.createElement(h.Table,{columns:this.columns,datasets:(0,s.toJS)(e.topics),emptyLabel:"",rowKey:"id"}),l.default.createElement(E.default,{page:e.topicsPage,onChange:e.changeTopicsPage.bind(e)}))}}]),t}(u.PureComponent);t.default=(0,y.default)((0,f.observer)(k))},671:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=r(u),s=n(667),f=n(173),p=n(560),d=f.Tabs.TabPanel,y=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"render",value:function(){var e=this.props.store;return l.default.createElement("div",{style:{paddingTop:6}},l.default.createElement(f.Tabs,{type:"slider",activeId:e.tab,onTabChange:function(t){return e.fetchTopics({tab:t})}},p.tabs.map(function(e){return l.default.createElement(d,{key:e,id:e[0],tab:e[1]})})))}}]),t}(u.PureComponent);t.default=(0,s.observer)(y)},672:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=r(u),s=n(173),f=n(560),p=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.data,n=e.style;return t.top||t.good||t.tab?l.default.createElement("div",{style:n},t.top&&l.default.createElement(s.Button,{size:"small",type:"danger"},"置顶"),!t.top&&t.good&&l.default.createElement(s.Button,{size:"small",type:"success"},"精华"),!t.top&&!t.good&&t.tab&&l.default.createElement(s.Button,{size:"small",type:"success"},f.tabs[f.tabsIndex.get(t.tab)][1])):null}}]),t}(u.PureComponent);t.default=p},673:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=r(u),s=n(173),f={pagination:{display:"flex",justifyContent:"center",padding:"10px 0"},info:{lineHeight:"30px",fontSize:12,padding:"0 12px"}},p=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.page,n=e.onChange;return l.default.createElement("div",{style:f.pagination},l.default.createElement(s.Button,{disabled:1===t,onClick:function(){return n(+t-1)}},"上一页"),l.default.createElement("span",{style:f.info},"第",t,"页"),l.default.createElement(s.Button,{onClick:function(){return n(+t+1)}},"下一页"))}}]),t}(u.PureComponent);t.default=p},674:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=r(u),s=n(667),f=n(170),p=n(173),d=n(602),y=r(d),h=n(670),m=r(h),b=n(675),g=r(b),v=n(677),_=r(v),w=n(560),O=new m.default,E={article:{marginBottom:20},header:{padding:"18px 10px 10px 20px"},descWrapper:{margin:"6px 0 12px"},desc:{display:"inline-block",paddingRight:12,color:"#838383",fontSize:12},collect:{float:"right"}},j=function(e){function t(){var e,n,r,i;o(this,t);for(var c=arguments.length,u=Array(c),s=0;s<c;s++)u[s]=arguments[s];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.generateTopic=function(){var e=r.props.store,t=e.topic,n=e.currentUser,o=e.collectTopic,a=e.comment,i=e.changeComment,c=e.createComment,u=t.is_collect,s=t.id;return l.default.createElement("div",null,l.default.createElement("article",{className:"bg radius",style:E.article},l.default.createElement("div",{style:E.header},l.default.createElement("h2",null,t.title),n&&l.default.createElement(p.Button,{style:E.collect,type:u?"default":"primary",onClick:o.bind(r.props.store,s,u)},(u?"取消":"")+"收藏"),l.default.createElement("div",{style:E.descWrapper},l.default.createElement("span",{style:E.desc},"发布于：",O.format(t.created_at,"zh_CN")),l.default.createElement("span",{style:E.desc},"作者：",t.author.loginname),l.default.createElement("span",{style:E.desc},t.visit_count,"次浏览"),t.tab&&l.default.createElement("span",{style:E.desc},"来自",w.tabs[w.tabsIndex.get(t.tab)][1]))),l.default.createElement("div",{dangerouslySetInnerHTML:{__html:t.content},className:"markdown-body"})),t.replies.length>0&&l.default.createElement(g.default,{store:r.props.store,comments:(0,f.toJS)(t.replies),author:t.author}),n&&l.default.createElement(_.default,{topic_id:t.id,value:(0,f.toJS)(a),onChange:(0,f.toJS)(i.bind(r.props.store)),onSubmit:(0,f.toJS)(c.bind(r.props.store))}))},i=n,a(r,i)}return i(t,e),c(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.store,n=e.location,r=n.pathname.split("topic/")[1];t.fetchTopic(r)}},{key:"render",value:function(){var e=this.props.store;return l.default.createElement("div",null,e.topic&&this.generateTopic())}}]),t}(u.PureComponent);t.default=(0,y.default)((0,s.observer)(j))},675:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=r(u),s=n(562),f=n(602),p=r(f),d=n(670),y=r(d),h=n(173),m=n(676),b=r(m),g=new y.default,v={wrapper:{width:"100%"},inWrapper:{display:"inline-block",verticalAlign:"middle"},img:{width:30,height:30},info:{display:"inline-block",paddingLeft:12,color:"#838383",fontSize:12},author:{marginLeft:6},content:{marginLeft:24},agree:{float:"right",paddingTop:10,cursor:"pointer",color:"#eb0b19"}},_=function(e){function t(){var e,n,r,i;o(this,t);for(var c=arguments.length,u=Array(c),f=0;f<c;f++)u[f]=arguments[f];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.bodyRender=function(e){return l.default.createElement("div",{style:v.wrapper},l.default.createElement("div",{onClick:function(){return r.onAgree(e)},style:v.agree},l.default.createElement(h.Icon,{type:e.is_uped?"youzan":"youzan-o"})," ",e.ups.length>0?e.ups.length:""),l.default.createElement(s.Link,{to:"/user/"+e.author.loginname,style:v.inWrapper},l.default.createElement("img",{style:v.img,src:e.author.avatar_url,alt:""})),l.default.createElement("span",{style:v.info},e.author.loginname,"发表于",g.format(e.created_at,"zh_CN")),e.author.loginname===r.props.author.loginname&&l.default.createElement(h.Button,{style:v.author,size:"small",type:"success"},"作者"),l.default.createElement("div",{style:v.content,dangerouslySetInnerHTML:{__html:e.content},className:"markdown-body"}))},r.onAgree=function(e){var t=r.props.store;t.currentUser&&e.id&&t.agreeReply(e.id)},i=n,a(r,i)}return i(t,e),c(t,[{key:"render",value:function(){var e=this.props.comments;return l.default.createElement(b.default,{alert:"共"+e.length+"条",datasets:e,bodyRender:this.bodyRender})}}]),t}(u.PureComponent);t.default=(0,p.default)(_)},676:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=r(u),s=n(173),f=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.columns=[{width:"80%",bodyRender:e.bodyRender},{}],n}return i(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.alert,n=e.datasets;return l.default.createElement("div",{className:"bg radius"},l.default.createElement(s.Alert,{className:"radius-top top"},t),l.default.createElement(s.Table,{columns:this.columns,datasets:n,rowKey:"id",emptyLabel:""}))}}]),t}(u.PureComponent);t.default=f},677:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{
constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=r(u),s=n(173),f={wrapper:{backgroundColor:"#fff",overflow:"hidden"},textarea:{margin:20,minHeight:120,border:"none",outline:"none",boxShadow:"none"},submit:{display:"block",margin:"0 auto 20px"}},p=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"render",value:function(){var e=this;return l.default.createElement("div",{style:f.wrapper},l.default.createElement(s.Alert,null,"评论"),l.default.createElement(s.Input,{style:f.textarea,type:"textarea",value:this.props.value,onChange:function(t){return e.props.onChange(t.target.value)}}),l.default.createElement(s.Button,{style:f.submit,type:"primary",onClick:function(){return e.props.onSubmit(e.props.topic_id,e.props.value)}},"提交"))}}]),t}(u.PureComponent);t.default=p},678:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=n(1),f=r(s),p=n(667),d=n(170),y=n(562),h=n(670),m=r(h),b=n(173),g=n(679),v=r(g),_=n(676),w=r(_),O=new m.default,E={wrapper:{display:"flex",alignItems:"center"},info:{display:"flex",alignItems:"center"},img:{width:30,height:30},loginname:{display:"inline-block",padding:"0 6px"},hint:{color:"#b4b4b4"},space:{marginRight:6}},j=function(e){return f.default.createElement("div",{style:E.wrapper},f.default.createElement("div",{style:E.info},f.default.createElement(y.Link,{to:"/user/"+e.author.loginname,style:E.info},f.default.createElement("img",{src:e.author.avatar_url,alt:"",style:E.img}),f.default.createElement("span",{style:E.loginname},e.author.loginname)),f.default.createElement("span",{style:l({},E.hint,E.space)},O.format(e.last_reply_at,"zh_CN"))),f.default.createElement(y.Link,{to:"/topic/"+e.id},e.title))},P=(0,p.observer)(c=function(e){function t(){var e,n,r,i;o(this,t);for(var c=arguments.length,u=Array(c),s=0;s<c;s++)u[s]=arguments[s];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.messagesBodyRender=function(e){return f.default.createElement("div",{style:E.wrapper},!e.has_read&&f.default.createElement(b.Button,{style:E.space,size:"small",onClick:r.props.store.markOne.bind(r.props.store,e.id)},"标为已读"),f.default.createElement("div",{style:E.info},f.default.createElement("span",{style:E.hint},e.author.loginname),f.default.createElement("span",{style:l({},E.hint,E.space)},"at"===e.type?"@":"回复","了你")),f.default.createElement(y.Link,{to:"/topic/"+e.topic.id},e.topic.title))},i=n,a(r,i)}return i(t,e),u(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.store,n=e.location,r=n.pathname.split("user/")[1];t.fetchUser(r),t.fetchCollectTopics(r),t.currentUser&&r===t.currentUser.loginname&&t.fetchMessages(r)}},{key:"componentWillReceiveProps",value:function(e){var t=e.location.pathname.split("user/")[1];t!==e.store.user.loginname&&(this.props.store.fetchUser(t),this.props.store.fetchCollectTopics(t))}},{key:"render",value:function(){var e=this.props,t=e.store,n=e.location,r=t.user,o=t.messages,a=t.currentUser;if(!r)return null;var i=n.pathname.split("user/")[1],c=a&&i===a.loginname;return f.default.createElement("div",null,f.default.createElement(v.default,{info:(0,d.toJS)(r)}),c&&o&&f.default.createElement(w.default,{alert:"未读消息",bodyRender:this.messagesBodyRender,datasets:(0,d.toJS)(o).hasnot_read_messages}),c&&o&&f.default.createElement(w.default,{alert:"已读消息",bodyRender:this.messagesBodyRender,datasets:(0,d.toJS)(o).has_read_messages}),f.default.createElement(w.default,{alert:"最近创建的话题",bodyRender:j,datasets:(0,d.toJS)(r).recent_topics}),f.default.createElement(w.default,{alert:"最近参与的话题",bodyRender:j,datasets:(0,d.toJS)(r).recent_replies}),f.default.createElement(w.default,{alert:"收藏的话题",bodyRender:j,datasets:(0,d.toJS)(t.collectTopics)}))}}]),t}(s.PureComponent))||c;t.default=P},679:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=r(u),s=n(602),f=r(s),p={wrapper:{display:"flex",marginBottom:20,padding:10},avatar:{height:60,width:60},items:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",marginLeft:12,fontSize:13},itemName:{fontSize:24},itemScore:{color:"#b4b4b4"}},d=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"render",value:function(){var e=this.props.info;return e?l.default.createElement("div",{className:"bg radius",style:p.wrapper},l.default.createElement("img",{style:p.avatar,src:e.avatar_url,alt:""}),l.default.createElement("div",{style:p.items},l.default.createElement("div",null,l.default.createElement("div",{style:p.itemName},e.loginname),l.default.createElement("div",{style:p.itemScore},e.score,"积分")))):null}}]),t}(u.PureComponent);t.default=(0,f.default)(d)},680:function(e,t){}});